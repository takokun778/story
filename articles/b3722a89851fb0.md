---
title: "Goè¨€èªãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆã®t.Parallel()"
emoji: "ğŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["go", "golang", "test"]
published: true
---

# ã¯ã˜ã‚ã«

Goè¨€èªã§ãƒ†ãƒ¼ãƒ–ãƒ«é§†å‹•ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ãŸã¨ãã« `t.Parallel()`ã‚’ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«é–¢æ•°ã§æ›¸ãã®ã¨ã‚µãƒ–ãƒ¬ãƒ™ãƒ«é–¢æ•°ã§æ›¸ãã®ã¨ã§ã©ã†ã‚„ã£ã¦æŒ™å‹•ãŒå¤‰ã‚ã‚‹ã®ã‹ã¡ã‚ƒã¡ã‚ƒã£ã¨å‹•ã‹ã—ã¦è¦‹ãŸçµæœã®å…±æœ‰ã§ã™ã€‚

# å‹•ä½œç’°å¢ƒ

```bash
go version go1.19.4 linux/amd64
```

```bash
uname -a
Linux HP-Spectre-x360 5.15.79.1-microsoft-standard-WSL2 #1 SMP Wed Nov 23 01:01:46 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
```

# ã‚³ãƒ¼ãƒ‰

`main.go`
```go
package main

import (
	"log"
	"time"
)

func main() {}

func Hello(v string) {
	time.Sleep(1000 * time.Millisecond)
	log.Printf("Hello %s\n", v)
}

```

`main_test.go`

`func TestHello1()`: ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«é–¢æ•°ã¨ã‚µãƒ–ãƒ¬ãƒ™ãƒ«é–¢æ•°ã«`t.Parallel()`ã‚’è¨˜è¿°
`func TestHello2()`: ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«é–¢æ•°ã«ã®ã¿`t.Parallel()`ã‚’è¨˜è¿°

```go
package main

import (
	"fmt"
	"testing"
)

// ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«é–¢æ•°
func TestHello1(t *testing.T) {
	t.Parallel()

	type args struct {
		v string
	}

	tests := []struct {
		name string
		args args
	}{
		{
			name: "1",
			args: args{
				v: "1",
			},
		},
		{
			name: "2",
			args: args{
				v: "2",
			},
		},
		{
			name: "3",
			args: args{
				v: "3",
			},
		},
		{
			name: "4",
			args: args{
				v: "4",
			},
		},
		{
			name: "5",
			args: args{
				v: "5",
			},
		},
	}

	for _, tt := range tests {
		tt := tt
        // ã‚µãƒ–ãƒ¬ãƒ™ãƒ«é–¢æ•°
		t.Run(tt.name, func(t *testing.T) {
			t.Parallel()
			Hello(fmt.Sprintf("1-%s", tt.args.v))
		})
	}
}

// ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«é–¢æ•°
func TestHello2(t *testing.T) {
	t.Parallel()

	type args struct {
		v string
	}

	tests := []struct {
		name string
		args args
	}{
		{
			name: "1",
			args: args{
				v: "1",
			},
		},
		{
			name: "2",
			args: args{
				v: "2",
			},
		},
		{
			name: "3",
			args: args{
				v: "3",
			},
		},
		{
			name: "4",
			args: args{
				v: "4",
			},
		},
		{
			name: "5",
			args: args{
				v: "5",
			},
		},
	}

	for _, tt := range tests {
        // ã‚µãƒ–ãƒ¬ãƒ™ãƒ«é–¢æ•°
		t.Run(tt.name, func(t *testing.T) {
			Hello(fmt.Sprintf("2-%s", tt.args.v))
		})
	}
}

```

# çµæœ

```go
go test ./... -v

=== RUN   TestHello1
=== PAUSE TestHello1
=== RUN   TestHello2
=== PAUSE TestHello2
=== CONT  TestHello1
=== RUN   TestHello1/1
=== PAUSE TestHello1/1
=== RUN   TestHello1/2
=== PAUSE TestHello1/2
=== RUN   TestHello1/3
=== PAUSE TestHello1/3
=== RUN   TestHello1/4
=== PAUSE TestHello1/4
=== RUN   TestHello1/5
=== PAUSE TestHello1/5
=== CONT  TestHello1/1
=== CONT  TestHello2
=== RUN   TestHello2/1
2022/12/27 00:55:29 Hello 2-1
=== RUN   TestHello2/2
2022/12/27 00:55:29 Hello 1-1
=== CONT  TestHello1/5
2022/12/27 00:55:30 Hello 1-5
=== CONT  TestHello1/4
2022/12/27 00:55:30 Hello 2-2
=== RUN   TestHello2/3
2022/12/27 00:55:31 Hello 1-4
=== CONT  TestHello1/3
2022/12/27 00:55:31 Hello 2-3
=== RUN   TestHello2/4
2022/12/27 00:55:32 Hello 1-3
=== CONT  TestHello1/2
2022/12/27 00:55:32 Hello 2-4
=== RUN   TestHello2/5
2022/12/27 00:55:33 Hello 1-2
--- PASS: TestHello1 (0.00s)
    --- PASS: TestHello1/1 (1.00s)
    --- PASS: TestHello1/5 (1.05s)
    --- PASS: TestHello1/4 (1.07s)
    --- PASS: TestHello1/3 (1.03s)
    --- PASS: TestHello1/2 (1.01s)
2022/12/27 00:55:33 Hello 2-5
--- PASS: TestHello2 (5.16s)
    --- PASS: TestHello2/1 (1.00s)
    --- PASS: TestHello2/2 (1.05s)
    --- PASS: TestHello2/3 (1.07s)
    --- PASS: TestHello2/4 (1.03s)
    --- PASS: TestHello2/5 (1.01s)
PASS
ok      goparalleltest  5.166s
```

# ãŠã‚ã‚Šã«

- `TestHello1`ã¨`TestHello2`ã¯å¹³è¡Œã§å®Ÿè¡Œ
- `TestHello1`å†…ã¯å¹³è¡Œ
- `TestHello2`å†…ã¯ç›´åˆ—

ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚ã€‚ã€‚
